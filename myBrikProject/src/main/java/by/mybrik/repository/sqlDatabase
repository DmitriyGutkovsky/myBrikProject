create table m_users
(
	id bigserial not null,
	name varchar(100) not null,
	surname varchar(100),
	login varchar(100) not null,
	password varchar(100) not null,
	email varchar(100) not null,
	gender varchar(50),
	created timestamp(3) default current_timestamp,
	changed timestamp(3) default current_timestamp,
	phone int not null,
	address varchar(100),
	"isDeleted" boolean default false
);

create index m_users_address_index
	on m_users (address);

create unique index m_users_id_uindex
	on m_users (id);

create index m_users_login_index
	on m_users (login);

create index m_users_name_index
	on m_users (name);

create index m_users_surname_index
	on m_users (surname);

alter table m_users
	add constraint m_users_pk
		primary key (id);

alter table m_users alter column gender set not null;

alter table m_users alter column gender set default 'NOT_SELECTED'::character varying;


-- table for standard goods

create table m_goods
(
	id bigserial not null,
	order_code varchar(100) not null,
	name varchar(200) not null,
	photo varchar(300),
	gender varchar(50) default 'unisex'::character varying not null,
	size varchar(50) not null,
	color varchar(100) not null,
	description varchar(700),
	"isDeleted" boolean default false not null,
	price double precision,
	quantity int,
	created timestamp(3) default current_timestamp,
	changed timestamp(3) default current_timestamp
);

create index m_goods_color_index
	on m_goods (color);

create index m_goods_gender_index
	on m_goods (gender);

create unique index m_goods_id_uindex
	on m_goods (id);

create index m_goods_name_index
	on m_goods (name);

create index m_goods_order_code_index
	on m_goods (order_code);

create index m_goods_price_index
	on m_goods (price);

create index m_goods_size_index
	on m_goods (size);

alter table m_goods
	add constraint m_goods_pk
		primary key (id);

alter table m_goods
	add category varchar not null;

create index m_goods_category_index
	on m_goods (category);

alter table m_goods alter column category type varchar(100) using category::varchar(100);


create table m_standard_order
(
	id bigserial not null,
	good_id bigint not null
		constraint m_standard_order_m_goods_id_fk
			references m_goods,
	user_id bigint not null
		constraint m_standard_order_m_users_id_fk
			references m_users
				on update cascade on delete cascade,
	quantity int not null,
	total_price double precision,
	order_status varchar(50),
	changed timestamp default current_timestamp,
	created timestamp(3) default current_timestamp
);

create index m_standard_order_good_id_index
	on m_standard_order (good_id);

create unique index m_standard_order_id_uindex
	on m_standard_order (id);

create index m_standard_order_order_status_index
	on m_standard_order (order_status);

create index m_standard_order_user_id_index
	on m_standard_order (user_id);

alter table m_standard_order
	add constraint m_standard_order_pk
		primary key (id);



